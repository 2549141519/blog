<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Nameless Monster</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="ç‚¹å‡»è¿”å›ğŸ”—æˆ‘çš„åšå®¢æ–‡ç« ç›®å½•

ç›®å½•
{:toc}


1. å‰è¨€
æœ¬æ–‡å°†å®ç°MapReduceå’ŒNoSQLæ•°æ®åº“çš„äº¤äº’ï¼Œç»Ÿè®¡å•è¯å‡ºç°æ¬¡æ•°ã€‚
NoSQLæ•°æ®åº“é€‰ç”¨redis6.0ï¼Œä»¥ä¸‹æ˜¯redisæ“ä½œçš„ä¸€äº›å‘½ä»¤(æˆ‘è®¾ç½®çš„redis6.0ç«¯å£ä¸º6380)ï¼š

sudo redis-server /etc/redis/redis.conf
//å¯åŠ¨redis6.0å®ä¾‹
redis-cli -p 6380
//è¿æ¥redis6.0å®ä¾‹,6380ä¸ºç«¯å£å·
redis-cli -p 6380 KEYS &ldquo;key*&rdquo; | xargs redis-cli -p 6380 DEL
//åˆ é™¤redis6.0å®ä¾‹ä¸­ä»¥key*ä¸ºå‰ç¼€çš„æ‰€æœ‰key
2. ä½¿ç”¨goè¯­è¨€å®ç°
2.1 ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis
éšæœºç”Ÿæˆ1ä¸‡ä¸ªå•è¯ï¼Œå¹¶å†™å…¥redisæ•°æ®åº“ä¸­ï¼š

package main
import (
&ldquo;context&rdquo;
&ldquo;fmt&rdquo;
&ldquo;math/rand&rdquo;
&ldquo;time&rdquo;
&ldquo;github.com/go-redis/redis/v8&rdquo;
)
// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
func randomString(n int) string {
letters := []rune(&ldquo;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&rdquo;)
s := make([]rune, n)
for i := range s {
s[i] = letters[rand.Intn(len(letters))]
}
return string(s)
}
// ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis
func generateDataAndSaveToRedis(rdb *redis.Client, count int) {
ctx := context.Background()
for i := 0; i &lt; count; i&#43;&#43; {
key := fmt.Sprintf(&ldquo;key%d&rdquo;, i)
value := randomString(3) // ç”Ÿæˆé•¿åº¦ä¸º3çš„éšæœºå­—ç¬¦ä¸²
err := rdb.Set(ctx, key, value, 0).Err()
if err != nil {
panic(err)
}
}
fmt.Printf(&ldquo;Successfully generated and saved %d random data entries to Redis.\n&rdquo;, count)
}
func main() {
// è®¾ç½®éšæœºç§å­
rand.Seed(time.Now().UnixNano())
// è¿æ¥åˆ°Redis
rdb := redis.NewClient(&amp;redis.Options{
Addr: &ldquo;localhost:6380&rdquo;, // RedisæœåŠ¡å™¨åœ°å€
DB:   0,                // ä½¿ç”¨é»˜è®¤çš„DB
})
// ç”Ÿæˆ10000ä¸ªéšæœºæ•°æ®å¹¶å­˜å…¥Redis
generateDataAndSaveToRedis(rdb, 10000)
}">
    <meta name="generator" content="Hugo 0.145.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >




    


    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/mapreduce-for-nosql/">
    

    <meta property="og:url" content="http://localhost:1313/posts/mapreduce-for-nosql/">
  <meta property="og:site_name" content="Nameless Monster">
  <meta property="og:title" content="Nameless Monster">
  <meta property="og:description" content="ç‚¹å‡»è¿”å›ğŸ”—æˆ‘çš„åšå®¢æ–‡ç« ç›®å½•
ç›®å½• {:toc} 1. å‰è¨€ æœ¬æ–‡å°†å®ç°MapReduceå’ŒNoSQLæ•°æ®åº“çš„äº¤äº’ï¼Œç»Ÿè®¡å•è¯å‡ºç°æ¬¡æ•°ã€‚ NoSQLæ•°æ®åº“é€‰ç”¨redis6.0ï¼Œä»¥ä¸‹æ˜¯redisæ“ä½œçš„ä¸€äº›å‘½ä»¤(æˆ‘è®¾ç½®çš„redis6.0ç«¯å£ä¸º6380)ï¼š
sudo redis-server /etc/redis/redis.conf
//å¯åŠ¨redis6.0å®ä¾‹
redis-cli -p 6380
//è¿æ¥redis6.0å®ä¾‹,6380ä¸ºç«¯å£å·
redis-cli -p 6380 KEYS â€œkey*â€ | xargs redis-cli -p 6380 DEL
//åˆ é™¤redis6.0å®ä¾‹ä¸­ä»¥key*ä¸ºå‰ç¼€çš„æ‰€æœ‰key
2. ä½¿ç”¨goè¯­è¨€å®ç° 2.1 ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis éšæœºç”Ÿæˆ1ä¸‡ä¸ªå•è¯ï¼Œå¹¶å†™å…¥redisæ•°æ®åº“ä¸­ï¼š
package main
import (
â€œcontextâ€
â€œfmtâ€
â€œmath/randâ€
â€œtimeâ€
â€œgithub.com/go-redis/redis/v8â€
)
// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
func randomString(n int) string {
letters := []rune(â€œabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZâ€)
s := make([]rune, n)
for i := range s {
s[i] = letters[rand.Intn(len(letters))]
}
return string(s)
}
// ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis
func generateDataAndSaveToRedis(rdb *redis.Client, count int) {
ctx := context.Background()
for i := 0; i &lt; count; i&#43;&#43; {
key := fmt.Sprintf(â€œkey%dâ€, i)
value := randomString(3) // ç”Ÿæˆé•¿åº¦ä¸º3çš„éšæœºå­—ç¬¦ä¸²
err := rdb.Set(ctx, key, value, 0).Err()
if err != nil {
panic(err)
}
}
fmt.Printf(â€œSuccessfully generated and saved %d random data entries to Redis.\nâ€, count)
}
func main() {
// è®¾ç½®éšæœºç§å­
rand.Seed(time.Now().UnixNano())
// è¿æ¥åˆ°Redis
rdb := redis.NewClient(&amp;redis.Options{
Addr: â€œlocalhost:6380â€, // RedisæœåŠ¡å™¨åœ°å€
DB: 0, // ä½¿ç”¨é»˜è®¤çš„DB
})
// ç”Ÿæˆ10000ä¸ªéšæœºæ•°æ®å¹¶å­˜å…¥Redis
generateDataAndSaveToRedis(rdb, 10000)
}">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">

  <meta itemprop="name" content="Nameless Monster">
  <meta itemprop="description" content="ç‚¹å‡»è¿”å›ğŸ”—æˆ‘çš„åšå®¢æ–‡ç« ç›®å½•
ç›®å½• {:toc} 1. å‰è¨€ æœ¬æ–‡å°†å®ç°MapReduceå’ŒNoSQLæ•°æ®åº“çš„äº¤äº’ï¼Œç»Ÿè®¡å•è¯å‡ºç°æ¬¡æ•°ã€‚ NoSQLæ•°æ®åº“é€‰ç”¨redis6.0ï¼Œä»¥ä¸‹æ˜¯redisæ“ä½œçš„ä¸€äº›å‘½ä»¤(æˆ‘è®¾ç½®çš„redis6.0ç«¯å£ä¸º6380)ï¼š
sudo redis-server /etc/redis/redis.conf
//å¯åŠ¨redis6.0å®ä¾‹
redis-cli -p 6380
//è¿æ¥redis6.0å®ä¾‹,6380ä¸ºç«¯å£å·
redis-cli -p 6380 KEYS â€œkey*â€ | xargs redis-cli -p 6380 DEL
//åˆ é™¤redis6.0å®ä¾‹ä¸­ä»¥key*ä¸ºå‰ç¼€çš„æ‰€æœ‰key
2. ä½¿ç”¨goè¯­è¨€å®ç° 2.1 ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis éšæœºç”Ÿæˆ1ä¸‡ä¸ªå•è¯ï¼Œå¹¶å†™å…¥redisæ•°æ®åº“ä¸­ï¼š
package main
import (
â€œcontextâ€
â€œfmtâ€
â€œmath/randâ€
â€œtimeâ€
â€œgithub.com/go-redis/redis/v8â€
)
// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
func randomString(n int) string {
letters := []rune(â€œabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZâ€)
s := make([]rune, n)
for i := range s {
s[i] = letters[rand.Intn(len(letters))]
}
return string(s)
}
// ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis
func generateDataAndSaveToRedis(rdb *redis.Client, count int) {
ctx := context.Background()
for i := 0; i &lt; count; i&#43;&#43; {
key := fmt.Sprintf(â€œkey%dâ€, i)
value := randomString(3) // ç”Ÿæˆé•¿åº¦ä¸º3çš„éšæœºå­—ç¬¦ä¸²
err := rdb.Set(ctx, key, value, 0).Err()
if err != nil {
panic(err)
}
}
fmt.Printf(â€œSuccessfully generated and saved %d random data entries to Redis.\nâ€, count)
}
func main() {
// è®¾ç½®éšæœºç§å­
rand.Seed(time.Now().UnixNano())
// è¿æ¥åˆ°Redis
rdb := redis.NewClient(&amp;redis.Options{
Addr: â€œlocalhost:6380â€, // RedisæœåŠ¡å™¨åœ°å€
DB: 0, // ä½¿ç”¨é»˜è®¤çš„DB
})
// ç”Ÿæˆ10000ä¸ªéšæœºæ•°æ®å¹¶å­˜å…¥Redis
generateDataAndSaveToRedis(rdb, 10000)
}">
  <meta itemprop="wordCount" content="475">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Nameless Monster">
  <meta name="twitter:description" content="ç‚¹å‡»è¿”å›ğŸ”—æˆ‘çš„åšå®¢æ–‡ç« ç›®å½•
ç›®å½• {:toc} 1. å‰è¨€ æœ¬æ–‡å°†å®ç°MapReduceå’ŒNoSQLæ•°æ®åº“çš„äº¤äº’ï¼Œç»Ÿè®¡å•è¯å‡ºç°æ¬¡æ•°ã€‚ NoSQLæ•°æ®åº“é€‰ç”¨redis6.0ï¼Œä»¥ä¸‹æ˜¯redisæ“ä½œçš„ä¸€äº›å‘½ä»¤(æˆ‘è®¾ç½®çš„redis6.0ç«¯å£ä¸º6380)ï¼š
sudo redis-server /etc/redis/redis.conf
//å¯åŠ¨redis6.0å®ä¾‹
redis-cli -p 6380
//è¿æ¥redis6.0å®ä¾‹,6380ä¸ºç«¯å£å·
redis-cli -p 6380 KEYS â€œkey*â€ | xargs redis-cli -p 6380 DEL
//åˆ é™¤redis6.0å®ä¾‹ä¸­ä»¥key*ä¸ºå‰ç¼€çš„æ‰€æœ‰key
2. ä½¿ç”¨goè¯­è¨€å®ç° 2.1 ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis éšæœºç”Ÿæˆ1ä¸‡ä¸ªå•è¯ï¼Œå¹¶å†™å…¥redisæ•°æ®åº“ä¸­ï¼š
package main
import (
â€œcontextâ€
â€œfmtâ€
â€œmath/randâ€
â€œtimeâ€
â€œgithub.com/go-redis/redis/v8â€
)
// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
func randomString(n int) string {
letters := []rune(â€œabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZâ€)
s := make([]rune, n)
for i := range s {
s[i] = letters[rand.Intn(len(letters))]
}
return string(s)
}
// ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis
func generateDataAndSaveToRedis(rdb *redis.Client, count int) {
ctx := context.Background()
for i := 0; i &lt; count; i&#43;&#43; {
key := fmt.Sprintf(â€œkey%dâ€, i)
value := randomString(3) // ç”Ÿæˆé•¿åº¦ä¸º3çš„éšæœºå­—ç¬¦ä¸²
err := rdb.Set(ctx, key, value, 0).Err()
if err != nil {
panic(err)
}
}
fmt.Printf(â€œSuccessfully generated and saved %d random data entries to Redis.\nâ€, count)
}
func main() {
// è®¾ç½®éšæœºç§å­
rand.Seed(time.Now().UnixNano())
// è¿æ¥åˆ°Redis
rdb := redis.NewClient(&amp;redis.Options{
Addr: â€œlocalhost:6380â€, // RedisæœåŠ¡å™¨åœ°å€
DB: 0, // ä½¿ç”¨é»˜è®¤çš„DB
})
// ç”Ÿæˆ10000ä¸ªéšæœºæ•°æ®å¹¶å­˜å…¥Redis
generateDataAndSaveToRedis(rdb, 10000)
}">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Nameless Monster
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1"></h1>
      
      
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>ç‚¹å‡»è¿”å›<a href="https://2549141519.github.io/#/toc">ğŸ”—æˆ‘çš„åšå®¢æ–‡ç« ç›®å½•</a></p>
<ul>
<li>ç›®å½•
{:toc}</li>
</ul>
<!-- raw HTML omitted -->
<h1 id="1-å‰è¨€">1. å‰è¨€</h1>
<p>æœ¬æ–‡å°†å®ç°MapReduceå’ŒNoSQLæ•°æ®åº“çš„äº¤äº’ï¼Œç»Ÿè®¡å•è¯å‡ºç°æ¬¡æ•°ã€‚
NoSQLæ•°æ®åº“é€‰ç”¨redis6.0ï¼Œä»¥ä¸‹æ˜¯redisæ“ä½œçš„ä¸€äº›å‘½ä»¤(æˆ‘è®¾ç½®çš„redis6.0ç«¯å£ä¸º6380)ï¼š</p>
<blockquote>
<p>sudo redis-server /etc/redis/redis.conf<br>
//å¯åŠ¨redis6.0å®ä¾‹<br>
redis-cli -p 6380<br>
//è¿æ¥redis6.0å®ä¾‹,6380ä¸ºç«¯å£å·<br>
redis-cli -p 6380 KEYS &ldquo;key*&rdquo; | xargs redis-cli -p 6380 DEL<br>
//åˆ é™¤redis6.0å®ä¾‹ä¸­ä»¥key*ä¸ºå‰ç¼€çš„æ‰€æœ‰key</p></blockquote>
<h1 id="2-ä½¿ç”¨goè¯­è¨€å®ç°">2. ä½¿ç”¨goè¯­è¨€å®ç°</h1>
<h2 id="21-ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥redis">2.1 ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis</h2>
<p>éšæœºç”Ÿæˆ1ä¸‡ä¸ªå•è¯ï¼Œå¹¶å†™å…¥redisæ•°æ®åº“ä¸­ï¼š</p>
<blockquote>
<p>package main<br>
import (<br>
&ldquo;context&rdquo;<br>
&ldquo;fmt&rdquo;<br>
&ldquo;math/rand&rdquo;<br>
&ldquo;time&rdquo;<br>
&ldquo;github.com/go-redis/redis/v8&rdquo;<br>
)<br>
// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²<br>
func randomString(n int) string {<br>
letters := []rune(&ldquo;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&rdquo;)<br>
s := make([]rune, n)<br>
for i := range s {<br>
s[i] = letters[rand.Intn(len(letters))]<br>
}<br>
return string(s)<br>
}<br>
// ç”Ÿæˆéšæœºæ•°æ®å¹¶å­˜å…¥Redis<br>
func generateDataAndSaveToRedis(rdb *redis.Client, count int) {<br>
ctx := context.Background()<br>
for i := 0; i &lt; count; i++ {<br>
key := fmt.Sprintf(&ldquo;key%d&rdquo;, i)<br>
value := randomString(3) // ç”Ÿæˆé•¿åº¦ä¸º3çš„éšæœºå­—ç¬¦ä¸²<br>
err := rdb.Set(ctx, key, value, 0).Err()<br>
if err != nil {<br>
panic(err)<br>
}<br>
}<br>
fmt.Printf(&ldquo;Successfully generated and saved %d random data entries to Redis.\n&rdquo;, count)<br>
}<br>
func main() {<br>
// è®¾ç½®éšæœºç§å­<br>
rand.Seed(time.Now().UnixNano())<br>
// è¿æ¥åˆ°Redis<br>
rdb := redis.NewClient(&amp;redis.Options{<br>
Addr: &ldquo;localhost:6380&rdquo;, // RedisæœåŠ¡å™¨åœ°å€<br>
DB:   0,                // ä½¿ç”¨é»˜è®¤çš„DB<br>
})<br>
// ç”Ÿæˆ10000ä¸ªéšæœºæ•°æ®å¹¶å­˜å…¥Redis<br>
generateDataAndSaveToRedis(rdb, 10000)<br>
}</p></blockquote>
<p>æ‰§è¡Œå‘½ä»¤ï¼šgo run Generate_random_data.go<br>
<img src="../blogImg/MapReduce1.PNG" alt="Alt text"></p>
<h2 id="22-è¯»å–redisæ•°æ®åˆ°æ–‡ä»¶">2.2 è¯»å–Redisæ•°æ®åˆ°æ–‡ä»¶</h2>
<p>è¯»å–Redisæ•°æ®åˆ°æ–‡ä»¶ï¼š</p>
<blockquote>
<p>package main<br>
import (<br>
&ldquo;bufio&rdquo;<br>
&ldquo;context&rdquo;<br>
&ldquo;fmt&rdquo;<br>
&ldquo;os&rdquo;<br>
&ldquo;github.com/go-redis/redis/v8&rdquo;<br>
)<br>
// ä»Redisä¸­è¯»å–æ‰€æœ‰æ•°æ®<br>
func fetchDataFromRedis(rdb <em>redis.Client) map[string]string {<br>
ctx := context.Background()<br>
keys, err := rdb.Keys(ctx, &ldquo;</em>&rdquo;).Result()<br>
if err != nil {<br>
panic(err)<br>
}<br>
data := make(map[string]string)<br>
for _, key := range keys {<br>
value, err := rdb.Get(ctx, key).Result()<br>
if err != nil {<br>
panic(err)<br>
}<br>
data[key] = value<br>
}<br>
return data<br>
}<br>
// å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶<br>
func writeDataToFile(data map[string]string, filename string) {<br>
file, err := os.Create(filename)<br>
if err != nil {<br>
panic(err)<br>
}<br>
defer file.Close()<br>
writer := bufio.NewWriter(file)<br>
for key, value := range data {<br>
fmt.Fprintf(writer, &ldquo;%s\t%s\n&rdquo;, key, value)<br>
}<br>
writer.Flush()<br>
fmt.Printf(&ldquo;Data successfully written to %s\n&rdquo;, filename)<br>
}<br>
func main() {<br>
// è¿æ¥åˆ°Redis<br>
rdb := redis.NewClient(&amp;redis.Options{<br>
Addr: &ldquo;localhost:6380&rdquo;, // RedisæœåŠ¡å™¨åœ°å€<br>
DB:   0,                // ä½¿ç”¨é»˜è®¤çš„DB<br>
})<br>
// ä»Redisä¸­è¯»å–æ•°æ®<br>
data := fetchDataFromRedis(rdb)<br>
// å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä½œä¸ºMapReduceè¾“å…¥<br>
writeDataToFile(data, &ldquo;input.txt&rdquo;)<br>
}</p></blockquote>
<p>æ‰§è¡Œå‘½ä»¤ï¼šgo run Read_data.go<br>
<img src="../blogImg/MapReduce2.PNG" alt="Alt text"></p>
<p>æ­¤æ—¶input.txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š<br>
<img src="../blogImg/MapReduce3.PNG" alt="Alt text"></p>
<h2 id="23-mapreduceå®ç°">2.3 MapReduceå®ç°</h2>
<p>MapReduceå®ç°ï¼š</p>
<blockquote>
<p>package main<br>
import (<br>
&ldquo;bufio&rdquo;<br>
&ldquo;fmt&rdquo;<br>
&ldquo;os&rdquo;<br>
&ldquo;strings&rdquo;<br>
)<br>
// Mapå‡½æ•°å°†è¯»å–è¾“å…¥æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºæ¯ä¸ªå•è¯çš„é”®å€¼å¯¹ï¼ˆword, 1ï¼‰<br>
func mapFunction(filename string) map[string]int {<br>
file, err := os.Open(filename)<br>
if err != nil {<br>
panic(err)<br>
}<br>
defer file.Close()<br>
wordCount := make(map[string]int)<br>
scanner := bufio.NewScanner(file)<br>
for scanner.Scan() {<br>
line := scanner.Text()<br>
// å‡è®¾è¾“å…¥æ–‡ä»¶æ¯è¡Œçš„æ ¼å¼æ˜¯ &ldquo;key\tvalue&rdquo;<br>
parts := strings.Split(line, &ldquo;\t&rdquo;)<br>
if len(parts) != 2 {<br>
continue // è·³è¿‡æ ¼å¼ä¸æ­£ç¡®çš„è¡Œ<br>
}<br>
value := parts[1]<br>
words := strings.Fields(value)<br>
for _, word := range words {<br>
wordCount[word] += 1<br>
}<br>
}<br>
if err := scanner.Err(); err != nil {<br>
panic(err)<br>
}<br>
return wordCount<br>
}<br>
// Reduceå‡½æ•°å°†æ±‡æ€»Mapå‡½æ•°çš„è¾“å‡ºï¼Œè®¡ç®—æ¯ä¸ªå•è¯çš„æ€»æ¬¡æ•°<br>
func reduceFunction(mappedData map[string]int) map[string]int {<br>
reducedData := make(map[string]int)<br>
for word, count := range mappedData {<br>
reducedData[word] += count<br>
}<br>
return reducedData<br>
}<br>
// å°†ç»“æœå†™å…¥åˆ°æ–‡ä»¶ä¸­<br>
func writeResultToFile(result map[string]int, outputFilename string) {<br>
file, err := os.Create(outputFilename)<br>
if err != nil {<br>
panic(err)<br>
}<br>
defer file.Close()<br>
writer := bufio.NewWriter(file)<br>
for word, count := range result {<br>
fmt.Fprintf(writer, &ldquo;%s  %d\n&rdquo;, word, count)<br>
}<br>
writer.Flush()<br>
}<br>
func main() {<br>
// Mapé˜¶æ®µ<br>
mappedData := mapFunction(&ldquo;input.txt&rdquo;)<br>
// Reduceé˜¶æ®µ<br>
reducedData := reduceFunction(mappedData)<br>
// è¾“å‡ºç»“æœåˆ°æ–‡ä»¶<br>
writeResultToFile(reducedData, &ldquo;output.txt&rdquo;)<br>
fmt.Println(&ldquo;MapReduce job completed. Results written to output.txt&rdquo;)<br>
}</p></blockquote>
<p>æ‰§è¡Œå‘½ä»¤ï¼šgo run MapReduce.go<br>
<img src="../blogImg/MapReduce4.PNG" alt="Alt text"></p>
<p>output.txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š<br>
<img src="../blogImg/MapReduce5.PNG" alt="Alt text"></p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="http://localhost:1313/" >
    &copy;  Nameless Monster 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
